!function(){"use strict";window.angular.module("inplace",[]).constant("inplaceRichConfig",{title:!1,allowedContent:!0,autoParagraph:!1,removePlugins:"dragdrop, basket",floatSpaceDockedOffsetY:5,toolbar:[{name:"source",items:["Sourcedialog","Templates"]},{name:"elements",items:["NumberedList","BulletedList","Link","Unlink","-","Image","Flash","Table","HorizontalRule"]},{name:"styles",items:["Styles","Font","FontSize","lineheight"]},"/",{name:"text",items:["Bold","Italic","Underline","Strike","Subscript","RemoveFormat"]},{name:"text",items:["TextColor","BGColor"]},{name:"align",items:["Outdent","Indent","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"document",items:["PasteFromWord","Undo","Redo","Scayt"]},{name:"icons",items:["Emojione"]}],extraPlugins:"scriptencode,sourcedialog,codemirror,lineheight,bold,emojione,fontSizeExtend",codemirror:{},stylesSet:"inplaceStyles"})}(),function(s){"use strict";s.module("inplace").directive("inplaceStart",["$window","$compile","$rootScope","inplaceService",function(o,r,e,u){return{restrict:"A",scope:{},link:function(a,e,t,n){var i="[data-inplace-rich], [data-inplace-modal], [data-inplace-image], [data-inplace-autocomplete], [data-inplace-properties-new], [data-inplace-price], [data-inplace-price-panel], [data-inplace-switch]",l=o.matchMedia("(min-width: 75em)");function c(){var e=document.querySelectorAll(i);null!=e&&0<e.length&&Array.prototype.slice.call(e).forEach(function(e){var t=s.element(e),n=t.scope()||a;t.addClass("inplace-initialized"),r(e)(n.$new())})}l.matches&&c(),l.addListener(function(e){(e.matches?c:function(){u.destroyAll();var e=document.querySelectorAll(i);null!=e&&0<e.length&&Array.prototype.slice.call(e).forEach(function(e){s.element(e).removeClass("inplace-initialized")})})()})}}}]),s.module("inplace").directive("inplaceSwitch",[function(e){return{restrict:"A",scope:!0,controller:"InplaceSwitchCtrl",controllerAs:"inplaceSwitch",bindToController:!0}}]),s.module("inplace").directive("inplaceProgress",function(){return{restrict:"A",scope:{},controller:"InplaceProgressCtrl",controllerAs:"inplaceProgress",bindToController:!0,replace:!0,template:'<div class="inplace-progress icon-spinner-before icon-animate-spin-before" data-ng-if="inplaceProgress.state.show === true"></div>'}})}(window.angular),function(e){"use strict";var p=0,d=0,g=0,v=0;"undefined"!=typeof CKEDITOR&&null!=CKEDITOR&&!0===CKEDITOR.env.isCompatible&&(CKEDITOR.on("dialogDefinition",function(e){var t=e.data.name,e=e.data.definition;"table"==t&&((e=e.getContents("info")).get("txtWidth").default=null,e.get("txtBorder").default=null,e.get("txtCellPad").default=null,e.get("txtCellSpace").default=null)}),e.module("inplace").directive("inplaceRich",["$compile","$document","$locale","$timeout","$window","inplaceService","inplaceRichConfig",function(c,o,e,r,t,u,s){return{restrict:"A",scope:{inplaceRich:"&",inplaceUrl:"@",inplaceOnSave:"&"},controller:"InplaceRichCtrl",controllerAs:"inplaceRich",bindToController:!0,link:function(t,a,n,i){i.getParams=function(){return new Function("return "+a.attr("data-inplace-params"))()||{}};var l=angular.extend(angular.copy(s),window._LandingCKeditorConfig||{},i.inplaceRich()||{},{language:"ru-ru"===e.id?"ru":"uk-ua"===e.id?"ua":"en"});r(function(){var e;null==n.id&&(n.$set("id","inplaceRich_"+p),p+=1),!0===l.editorSimple&&(l.removePlugins="showborders, magicline",l.enterMode=CKEDITOR.ENTER_BR,l.forcePasteAsPlainText=!0,a.addClass("inplace-rich-simple")),a.find("script").removeAttr("type"),0===a.html().trim().length&&null!=n.placeholder&&(a.addClass("inplace-rich-empty"),a.text(n.placeholder)),i.initCKeditor=function(){a[0].removeEventListener("mouseover",e),a.attr("contenteditable","true"),l.basicEntities=!1,i.editor=CKEDITOR.inline(n.id,l),null!=i.editor&&(i.editor.on("instanceReady",function(e){!0===l.editorSimple&&(o[0].getElementById(e.editor.id+"_top").style.display="none")}),i.editor.on("focus",function(e){i.editor.getData().trim()===n.placeholder&&(a.removeClass("inplace-rich-empty"),i.editor.setData("")),t.$apply(function(){var e;i.active(),null==i.buttonsRendered||!1===i.buttonsRendered?(e=angular.element('<div inplace-rich-buttons="'+n.id+'" is-show="inplaceRich.isShow"></div>'),document.body.appendChild(e[0]),c(e)(t),i.buttonsRendered=!0):e=i.buttons.element,i.callCallbacks(i.callbacks)})}),i.editor.on("blur",function(e){setTimeout(function(){t.$apply(function(){(i.isShow=!1)!==i.clickedButtons&&null!=i.clickedButtons||i.save(),i.clickedButtons=!1,0===i.editor.getData().trim().length&&null!=n.placeholder&&(a.addClass("inplace-rich-empty"),i.editor.setData(n.placeholder))})},100)}),i.editor.on("key",function(e){var t,n;13===e.data.keyCode&&!0===l.editorSimple&&(t=document.createElement("input"),n=a[0].getBoundingClientRect(),t.className="inplace-input-fake",t.style.top=n.top+"px",t.style.left=n.left+"px",document.body.appendChild(t),t.focus(),setTimeout(function(){t.parentNode.removeChild(t)},100),e.stop(),e.cancel())}))},e=i.initCKeditor,a[0].addEventListener("mouseover",e),a.addClass("inplace-initialized"),u.addRich(n.id,i,a[0])})}}}]),e.module("inplace").directive("inplaceRichButtons",function(){return{restrict:"A",scope:{inplaceRichButtons:"@",isShow:"<?",onInit:"&"},controller:"InplaceRichButtonsCtrl",controllerAs:"inplaceRichButtons",bindToController:!0,replace:!0,templateUrl:"/scripts/_partials/inplace/templates/richButtons.html"}}),e.module("inplace").directive("inplacePrice",["$compile","$document","$locale","$window","inplaceService","productService","domService",function(s,p,d,e,m,n,f){return{restrict:"A",scope:{inplaceParams:"&",inplaceUrl:"@"},controller:"InplacePriceCtrl",controllerAs:"inplacePrice",bindToController:!0,link:function(c,o,e,r){var u,t;r.product=n.getProduct(),o[0].classList.add("inplace-price-container"),o[0].classList.add("inplace-offset"),t=function(e){var t,n=f.closest(e.target,".price-current"),a=f.closest(e.target,".price-unknow"),i=f.closest(e.target,".price-old"),l=f.closest(e.target,".price-discount-percent"),e={language:"ru-ru"===d.id?"ru":"uk-ua"===d.id?"ua":"en"};null!=n?(t=n,r.type="price"):null!=a?(t=a,r.type="price"):null!=i?(t=i,r.type="price"):null!=l&&(t=l,r.type="discountPercent"),null==t||!1===r.needReinit[r.type]&&null!=u||(r.needReinit[r.type]=!0,null!=(u=t.querySelector(".price-number")||a||l)&&(null!=u.id&&0!==u.id.length||(u.id="inplacePrice_"+v,v+=1),null==CKEDITOR.instances[u.id]&&(e.removePlugins=" showborders, magicline",e.enterMode=CKEDITOR.ENTER_BR,e.forcePasteAsPlainText=!0,u.classList.add("inplace-rich-simple"),u.setAttribute("contenteditable","true"),r.editor=CKEDITOR.inline(u.id,e),r.editor.on("instanceReady",function(e){p[0].getElementById(e.editor.id+"_top").style.display="none"}),r.editor.on("focus",function(e){!0===u.classList.contains("price-unknown")&&null==r.convertToFloat(r.editor.getData({format:"text"}))&&r.editor.setData("0"),c.$apply(function(){var e,t;r.active(),null==r.buttonsRendered||!1===r.buttonsRendered?(e=angular.element('<div data-inplace-price-buttons="'+u.id+'"></div>'),document.body.appendChild(e[0]),s(e)(c),t=angular.element('<div data-inplace-price-panel="'+u.id+'"></div>'),document.body.appendChild(t[0]),s(t)(c),r.buttonsRendered=!0):(e=r.buttons.element,t=r.panel.element),r.callCallbacks(r.callbacks)})}),r.editor.on("blur",function(e){setTimeout(function(){c.$apply(function(){(r.isShow=!1)!==r.clickedButtons&&null!=r.clickedButtons||r.save(),r.clickedButtons=!1})},100)}),r.editor.on("key",function(e){var t,n;13===e.data.keyCode?(t=document.createElement("input"),n=o[0].getBoundingClientRect(),t.className="inplace-input-fake",t.style.top=n.top+"px",t.style.left=n.left+"px",document.body.appendChild(t),t.focus(),setTimeout(function(){t.parentNode.removeChild(t)},100),e.stop(),e.cancel()):null===r.convertToFloat(r.editor.getData())?u.classList.add("inplace-price-error"):u.classList.remove("inplace-price-error")}),m.addInplacePrice(u.id,r,u),o.addClass("inplace-initialized"))))},o[0].addEventListener("mouseover",function(e){c.$apply(function(){t(e)})})}}}]),e.module("inplace").directive("inplacePriceButtons",function(){return{restrict:"A",scope:{inplacePriceButtons:"@",onInit:"&"},controller:"InplacePriceButtonsCtrl",controllerAs:"inplacePriceButtons",bindToController:!0,replace:!0,templateUrl:"/scripts/_partials/inplace/templates/priceButtons.html"}}),e.module("inplace").directive("inplacePricePanel",function(){return{restrict:"A",scope:{inplacePricePanel:"@",onInit:"&"},controller:"InplacePricePanelCtrl",controllerAs:"inplacePricePanel",templateUrl:"/scripts/_partials/inplace/templates/pricePanel.html",replace:!0,bindToController:!0}})),e.module("inplace").directive("inplaceModal",[function(){return{restrict:"A",scope:{inplaceParams:"&",inplaceUrl:"@"},controller:"InplaceModalCtrl",controllerAs:"inplaceModal",bindToController:!0,link:function(t,e,n,a){e[0].addEventListener("click",function(e){e.preventDefault(),t.$apply(a.modalOpen)}),e.addClass("inplace-initialized")}}}]),e.module("inplace").directive("inplaceAutocomplete",["$compile","$document","$window","inplaceService",function(o,r,u,s){return{restrict:"A",scope:{inplaceParams:"&",autocompleteParams:"&inplaceAutocomplete",inplaceAutocompleteSelectorBlock:"@"},controller:"InplaceAutocompleteCtrl",controllerAs:"inplaceAutocomplete",bindToController:!0,templateUrl:"/scripts/_partials/inplace/templates/inplaceAutocomplete.html",replace:!0,transclude:!0,link:function(t,n,a,i,e){var l,c=n[0].querySelector("input"),e=e()[0];e&&(i.value=e.textContent),l=function(e,t){e.css({top:u.pageYOffset+t.bottom,right:r[0].body.clientWidth-t.right})},c.addEventListener("focus",function(){var e;n[0].classList.add("inplace-autocomplete-focus"),t.$apply(function(){i.startContent=i.value,i.active(),null==i.buttonsRendered&&(e=angular.element('<div inplace-autocomplete-buttons="'+a.id+'"></div>'),l(e,n[0].getBoundingClientRect()),document.body.appendChild(e[0]),o(e)(t),i.buttonsRendered=!0)})}),c.addEventListener("blur",function(){n[0].classList.remove("inplace-autocomplete-focus"),setTimeout(function(){t.$apply(function(){(i.isShow=!1)!==i.clickedButtons&&null!=i.clickedButtons||i.save(),i.clickedButtons=!1})},100)}),c.addEventListener("keyup",function(e){var t;13===e.keyCode&&(n[0].classList.remove("inplace-autocomplete-focus"),t=document.createElement("input"),e=n[0].getBoundingClientRect(),t.className="inplace-input-fake",t.style.top=e.top+"px",t.style.left=e.left+"px",document.body.appendChild(t),t.focus(),setTimeout(function(){t.parentNode.removeChild(t)},100))}),null==a.id&&(a.$set("id","inplaceAutocomplete_"+d),d+=1),s.addInplaceAutocomplete(a.id,i),n.addClass("inplace-initialized")}}}]),e.module("inplace").directive("inplaceAutocompleteButtons",function(){return{restrict:"A",scope:{inplaceAutocompleteButtons:"@"},controller:"InplaceAutocompleteButtonsCtrl",controllerAs:"inplaceAutocompleteButtons",bindToController:!0,replace:!0,templateUrl:"/scripts/_partials/inplace/templates/inplaceAutocompleteButtons.html"}}),e.module("inplace").directive("inplacePropertiesNew",function(){return{restrict:"A",scope:{productId:"@"},controller:"InplacePropertiesNewCtrl",controllerAs:"inplacePropertiesNew",bindToController:!0,replace:!0,templateUrl:"/scripts/_partials/inplace/templates/propertiesNew.html"}}),e.module("inplace").directive("inplaceImage",["$compile","$document","$parse","$timeout","$window","inplaceService",function(p,e,d,m,t,f){return{restrict:"A",require:["inplaceImage","^?carousel","?^productViewItem","?^^","?^zoomer"],scope:!0,controller:"InplaceImageCtrl",controllerAs:"inplaceImage",bindToController:!0,replace:!0,link:function(n,e,a,t){var i,l,c,o=t[0],r=t[1],u=t[2],s=t[4],t=document.querySelector('[data-ng-controller="ProductCtrl as product"]');null==a.id&&(a.$set("id","inplaceImage_"+g),g+=1),o.carousel=r,o.productViewItem=u,o.product=null!=t?angular.element(t).controller():null,o.inplaceParams=d(a.inplaceParams)(n),o.inplaceUrl=a.inplaceUrl,o.inplaceImageButtonsVisible=angular.extend({add:!0,update:!0,delete:!0,permanentVisible:!1},new Function("return "+a.inplaceImageButtonsVisible)()||{}),i=function(e,t){return null!=c&&(m.cancel(c),c=null),c=m(function(){return t.css({top:e[0].offsetTop+e[0].height,left:e[0].offsetLeft+e[0].width-t[0].offsetWidth}),!0},100)},l=function(e){var t=angular.element('<div inplace-image-buttons="'+a.id+'"></div>');e[0].parentNode.appendChild(t[0]),p(t)(n),m(function(){o.buttonsRendered=!0,i(e,t).finally(function(){o.buttons.rendered=!0})}).catch(function(e){})},u=function(){e[0].classList.add("inplace-image-focus"),n.$apply(function(){o.active(),null==o.buttonsRendered?l(e):null!=o.buttons&&null!=o.buttons.element&&i(e,o.buttons.element)})},t=function(){e[0].classList.remove("inplace-image-focus"),o.isActive=!1,m(function(){null==o.buttons||0!=o.buttons.isHoverButtons&&null!=o.buttons.isHoverButtons||!0===o.inplaceImageButtonsVisible.permanentVisible||(o.showButtons=!1)},100)},!0===o.inplaceImageButtonsVisible.permanentVisible&&l(e),null!=s?(e[0].parentNode.addEventListener("mouseenter",u),e[0].parentNode.addEventListener("mouseleave",t)):(e[0].addEventListener("mouseenter",u),e[0].addEventListener("mouseleave",t)),e.on("$destroy",function(){o.buttonsRendered=null}),f.addInplaceImage(a.id,o),e.addClass("inplace-initialized")}}}]),e.module("inplace").directive("inplaceImageButtons",function(){return{restrict:"A",scope:{inplaceImageButtons:"@"},controller:"InplaceImageButtonsCtrl",controllerAs:"inplaceImageButtons",bindToController:!0,replace:!0,templateUrl:"/scripts/_partials/inplace/templates/inplaceImageButtons.html",link:function(e,t,n,a){a.element=t,!0!==a.buttonsVisible.permanentVisible?(t[0].addEventListener("mouseenter",function(){e.$apply(function(){a.isHoverButtons=!0})}),t[0].addEventListener("mouseleave",function(){e.$apply(function(){a.isHoverButtons=!1}),setTimeout(function(){e.$apply(function(){0!=a.inplaceImage.isActive&&null!=a.inplaceImage.isActive||(a.inplaceImage.showButtons=!1)})},100)})):a.inplaceImage.showButtons=!0}}})}(window.angular),function(){"use strict";function e(t,n){this.change=function(e){n.setEnable(e).then(function(e){!0===e&&t.location.reload()})}}window.angular.module("inplace").controller("InplaceSwitchCtrl",e),e.$inject=["$window","inplaceService"]}(),function(){"use strict";function e(n,e,a,t,i,l){var c=this;c.callbacks=[],c.active=function(){c.isShow=!0,c.startContent=c.editor.getData()},c.destroy=function(){c.buttons&&c.buttons.element.remove(),c.editor&&(c.editor.destroy(),a.$destroy()),t.removeAttr("contenteditable")},c.save=function(){var e,t=c.editor.getData();c.startContent!==t&&(null!=c.inplaceUrl?(e=angular.extend(c.getParams(),{content:t}),n.save(c.inplaceUrl,e).finally(function(){c.isShow=!1,null!=c.inplaceOnSave&&c.inplaceOnSave({value:t,$scope:a})})):null!=c.inplaceOnSave&&c.inplaceOnSave({value:t,$scope:a}))},c.cancel=function(){c.isShow=!1,c.editor.setData(c.startContent)},c.addCallback=function(e){c.callbacks.push(e)},c.callCallbacks=function(e){e.forEach(function(e){e()})}}window.angular.module("inplace").controller("InplaceRichCtrl",e),e.$inject=["inplaceService","$q","$scope","$element","toaster","$translate"]}(),function(){"use strict";function e(t,e,n,a,i){var l=this;l.$onInit=function(){l.richCtrl=e.getRich(l.inplaceRichButtons),l.richCtrl.buttons={element:t,ctrl:l},null!=l.onInit&&l.onInit({callback:l.calcAndSetPositionButtons})},l.$postLink=function(){l.calcAndSetPositionButtons()},l.calcAndSetPositionButtons=function(){var e=l.richCtrl.elementTrigger.getBoundingClientRect();t.css({top:a.pageYOffset+e.bottom+"px",right:i[0].body.clientWidth-e.right+"px"})},l.btnSave=function(){l.richCtrl.clickedButtons=!0,l.richCtrl.save()},l.btnCancel=function(){l.richCtrl.clickedButtons=!0,l.richCtrl.cancel()},l.destroy=function(){n.$destroy(),t.remove()}}window.angular.module("inplace").controller("InplaceRichButtonsCtrl",e),e.$inject=["$element","inplaceService","$scope","$window","$document"]}(),function(){"use strict";function e(n,a,i,l,c,o){var r=this;r.$onInit=function(){r.inplaceParams=r.inplaceParams()},r.modalOpen=function(){var e,t;!1===c.hasModal("inplaceModal")&&c.renderModal("inplaceModal",o.instant("Js.Inplace.SeoSettings"),"<div data-ng-include=\"'/scripts/_partials/inplace/templates/modal.html'\"></div>","<div data-ng-include=\"'/scripts/_partials/inplace/templates/modalButtons.html'\"></div>",null,{inplace:r}),e=c.getModal("inplaceModal"),t=n.get("inplaceeditor/getmeta",{params:angular.extend(r.inplaceParams,{rnd:Math.random()})}),a.all([e,t]).then(function(e){c.open("inplaceModal"),r.startData=e[1].data,r.current=e[1].data,e[0].modalScope.formData=r.current}),r.apply=function(){l.save(r.inplaceUrl,angular.extend(r.inplaceParams,r.current)).then(function(){i.location.reload()})}},r.reset=function(){c.close("inplaceModal"),r.current=r.startData}}window.angular.module("inplace").controller("InplaceModalCtrl",e),e.$inject=["$http","$q","$window","inplaceService","modalService","$translate"]}(),function(){"use strict";function e(n,t,a,i,l,c,o){var r,u=this,s=!1;u.$onInit=function(){u.autocompleteParams=u.autocompleteParams(),u.inplaceParams=u.inplaceParams()},u.active=function(){u.isShow=!0},u.save=function(){u.startContent!==u.value&&l.save("inplaceeditor/propertyupdate",angular.extend(u.inplaceParams,{content:u.value})).then(function(e){e=e.data;!0===e.result?(c.pop("success",o.instant("Js.Inplace.PropertyHasBeenUpdate")),null!=e.obj&&angular.extend(u.inplaceParams,e.obj),u.startContent=u.value):c.pop("error",o.instant("Js.Inplace.ErrorPropertyUpdate"))}).catch(function(){c.pop("error",o.instant("Js.Inplace.ErrorPropertyUpdate"))}).finally(function(){u.isShow=!1})},u.cancel=function(){u.isShow=!1,u.value=u.startContent},u.autocompleteApply=function(e,t){u.inplaceParams.propertyValueId=null!=t?t.Key:null},u.delete=function(e){var t;null!=(t=null!=u.inplaceAutocompleteSelectorBlock?i.closest(e.target,u.inplaceAutocompleteSelectorBlock):t)&&t.parentNode.removeChild(t),u.value=null,l.save("inplaceeditor/propertydelete",angular.extend(u.inplaceParams,{content:u.value})).finally(function(){u.isShow=!1,c.pop("success",o.instant("Js.Inplace.PropertyHasBeenDelete")),u.getPropertiesHtml(u.inplaceParams.productId).then(function(e){u.generate(e)})})},u.getPropertiesHtml=function(e){return t.get("/product/productproperties",{params:{productId:e,renderInplaceBlock:!1,rnd:Math.random()}}).then(function(e){return e.data})},u.generate=function(e){var t;!1===s&&((t=document.getElementById("properties")).parentNode.removeChild(t),s=!0),(r=r||document.getElementById("inplacePropertiesNewContainer")).innerHTML=e,n(r)(a)}}window.angular.module("inplace").controller("InplaceAutocompleteCtrl",e),e.$inject=["$compile","$http","$scope","domService","inplaceService","toaster","$translate"]}(),function(){"use strict";function e(e){var t=this;t.$onInit=function(){t.inplaceAutocomplete=e.getInplaceAutocomplete(t.inplaceAutocompleteButtons)},t.btnSave=function(){t.inplaceAutocomplete.clickedButtons=!0,t.inplaceAutocomplete.save()},t.btnCancel=function(){t.inplaceAutocomplete.clickedButtons=!0,t.inplaceAutocomplete.cancel()}}window.angular.module("inplace").controller("InplaceAutocompleteButtonsCtrl",e),e.$inject=["inplaceService"]}(),function(){"use strict";function e(n,t,a,e,i,l,c){var o,r=!1,u=this;u.$onInit=function(){u.autocompleteValueParams={productId:u.productId},u.inplaceParams={productId:u.productId}},u.save=function(){e(function(){return l.save("inplaceeditor/propertyadd",angular.extend(u.inplaceParams,{name:u.name,value:u.value})).then(function(e){null!=e.data?(u.name="",u.value="",u.form.$setPristine(),u.inplaceParams.propertyId=null,u.inplaceParams.propertyValueId=null,i.pop("success",c.instant("Js.Inplace.PropertyHasBeenAdded")),u.htmlUpdate=!0,u.getPropertiesHtml(u.productId).then(function(e){u.generate(e)})):i.pop("error",c.instant("Js.Inplace.ErrorPropertyAdding"))})},100)},u.autocompleteNameApply=function(e,t){null!=t?(u.autocompleteValueParams.propertyId=t.Key,u.inplaceParams.propertyId=t.Key):(u.autocompleteValueParams.propertyId=null,u.inplaceParams.propertyId=null),u.inplaceParams.name=e},u.autocompleteValueApply=function(e,t){u.inplaceParams.propertyValueId=null!=t?t.Key:null,u.inplaceParams.value=e},u.getPropertiesHtml=function(e){return t.get("/product/productproperties",{params:{productId:e,renderInplaceBlock:!1,rnd:Math.random()}}).then(function(e){return e.data})},u.generate=function(e){var t;!1===r&&(null!=(t=document.getElementById("properties"))&&t.parentNode.removeChild(t),r=!0),(o=o||document.getElementById("inplacePropertiesNewContainer")).innerHTML=e,n(o)(a)}}window.angular.module("inplace").controller("InplacePropertiesNewCtrl",e),e.$inject=["$compile","$http","$scope","$timeout","toaster","inplaceService","$translate"]}(),function(){"use strict";function e(p,e,d,m,r,t,a){var f=this;f.$onInit=function(){f.tagImage=e[0],f.isActive=!1,f.isHoverButtons=!1},f.active=function(){f.isActive=!0,f.showButtons=!0},f.fileDrop=function(e,t,n){return f.fileChange(e,t,null!=f.inplaceParams.id&&0!==f.inplaceParams.id?"update":"add")},f.fileChange=function(e,t,n){if(null==n)throw Error("Parameter 'command' required for inplace image");return null!=f.productViewItem?(null!=f.productViewItem.picture.PhotoId&&angular.extend(f.inplaceParams,{id:f.productViewItem.picture.PhotoId}),null!=f.productViewItem.colorSelected&&angular.extend(f.inplaceParams,{colorId:f.productViewItem.colorSelected.ColorId})):null!=f.product&&(null!=f.product.picture.PhotoId&&"Review"!==f.inplaceParams.field&&angular.extend(f.inplaceParams,{id:f.product.picture.PhotoId}),null!=f.product.colorSelected&&angular.extend(f.inplaceParams,{colorId:f.product.colorSelected.ColorId})),f.inplaceParams.command=n,a.upload({url:f.inplaceUrl,data:angular.extend(f.inplaceParams,{rnd:Math.random()}),file:e}).then(function(e){switch(n){case"add":f.addedImage(e.data,f.inplaceParams.field);break;case"update":f.updatedImage(e.data,f.inplaceParams.field);break;case"delete":f.deletedImage(e.data,f.inplaceParams.field)}})},f.addedImage=function(e,t){var n,a,i,l,c,o,r=f.tagImage;if(null!=e&&0<e.length&&null!=t)switch(t){case"Logo":case"Brand":case"News":case"CategorySmall":case"CategoryBig":case"Review":r.src=e[0].filename;break;case"Product":for(var u=0,s=e.length;u<s;u++)r.src=e[u].filename,(l=new Function("return "+r.getAttribute("data-inplace-params"))()).id=e[u].id,r.setAttribute("data-inplace-params",JSON.stringify(l).replace(/"/g,"'")),0===u&&(null!=f.productViewItem?(f.productViewItem.picture.PhotoId=l.id,f.productViewItem.clearPhotos()):null!=f.product&&m.location.reload(!0));break;case"Carousel":i=(a=(n=f.carousel).carouselNative.getActiveItem().cloneNode(!0)).querySelector("[data-inplace-image]"),a.querySelector(".inplace-buttons").parentNode.removeChild(a.querySelector(".inplace-buttons")),(l=new Function("return "+i.getAttribute("data-inplace-params"))()).id=e[0].id,i.id="inplaceImage_"+e[0].id,i.setAttribute("data-inplace-params",JSON.stringify(l).replace(/"/g,"'")),(c=new Function("return "+i.getAttribute("data-inplace-image-buttons-visible"))()).add=!0,c.update=!0,c.delete=!0,c.permanentVisible=!1,i.setAttribute("data-inplace-image-buttons-visible",JSON.stringify(c).replace(/"/g,"'")),i.src=e[0].filename,1===n.carouselNative.items.length&&!0===(o=new Function("return "+n.carouselNative.getActiveItem().querySelector("[data-inplace-image]").getAttribute("data-inplace-image-buttons-visible"))()).add&&!1===o.update&&!1===o.delete&&n.carouselNative.removeItem(n.carouselNative.getActiveItem(),!1),n.carouselNative.addItem(a),i.complete&&void 0===i.naturalWidth&&0!==i.naturalWidth?(n.carouselNative.update(),n.carouselNative.goto(0<n.carouselNative.items.length?n.carouselNative.items.length-1:0)):i.onload=function(){n.carouselNative.update(),n.carouselNative.goto(0<n.carouselNative.items.length?n.carouselNative.items.length-1:0)},p(i)(d);break;default:throw Error("Unknow type for inplace image: "+t)}},f.updatedImage=function(e,t){var n,a=f.tagImage;if(null!=e&&0<e.length&&null!=t)switch(t){case"Logo":case"Brand":case"News":case"CategorySmall":case"CategoryBig":a.src=e[0].filename;break;case"Carousel":a.src=e[0].filename,f.carousel.carouselNative.update();break;case"Product":a.src=e[0].filename,(n=new Function("return "+a.getAttribute("data-inplace-params"))()).id=e[0].id,a.setAttribute("data-inplace-params",JSON.stringify(n).replace(/"/g,"'")),null!=f.productViewItem?(f.productViewItem.picture.PhotoId=n.id,f.productViewItem.clearPhotos()):null!=f.product&&m.location.reload();break;case"Review":a.src=e[0].filename,f.inplaceParams.id=e[0].id;break;default:throw Error("Unknow type for inplace image: "+t)}},f.deletedImage=function(e,t){var n,a,i,l,c,o=f.tagImage;if(null!=e&&0<e.length&&null!=t)switch(t){case"Logo":case"Brand":case"News":case"CategorySmall":case"CategoryBig":o.src=e[0].filename;break;case"Product":o.src=e[0].filename,(l=new Function("return "+o.getAttribute("data-inplace-params"))()).id=e[0].id,o.setAttribute("data-inplace-params",JSON.stringify(l).replace(/"/g,"'")),null!=f.productViewItem?(f.productViewItem.picture.PhotoId=l.id,f.productViewItem.clearPhotos()):null!=f.product&&m.location.reload();break;case"Review":o.src=e[0].filename,f.inplaceParams.id=e[0].id;break;case"Carousel":null!=(n=f.carousel)&&(1===n.carouselNative.items.length&&(i=(a=n.carouselNative.getActiveItem().cloneNode(!0)).querySelector("[data-inplace-image]"),a.querySelector(".inplace-buttons").parentNode.removeChild(a.querySelector(".inplace-buttons")),(l=new Function("return "+i.getAttribute("data-inplace-params"))()).id=0,i.setAttribute("data-inplace-params",JSON.stringify(l).replace(/"/g,"'")),(c=new Function("return "+i.getAttribute("data-inplace-image-buttons-visible"))()).update=!1,c.delete=!1,c.permanentVisible=!0,i.setAttribute("data-inplace-image-buttons-visible",JSON.stringify(c).replace(/"/g,"'")),i.src=e[0].filename),c=r.closest(o,".js-carousel-item").carouselItemData.index,n.carouselNative.removeItem(n.carouselNative.items[c],!1),null!=a&&(n.carouselNative.addItem(a),p(i)(d)),null==i||i.complete&&void 0===i.naturalWidth&&0!==i.naturalWidth?(n.carouselNative.update(),n.carouselNative.goto(n.carouselNative.items.length-1)):i.onload=function(){n.carouselNative.update(),n.carouselNative.goto(n.carouselNative.items.length-1)});break;default:throw Error("Unknow type for inplace image: "+t)}}}window.angular.module("inplace").controller("InplaceImageCtrl",e),e.$inject=["$compile","$element","$scope","$window","domService","inplaceService","Upload"]}(),function(){"use strict";function e(e){var n=this;n.$onInit=function(){n.inplaceImage=e.getInplaceImage(n.inplaceImageButtons),(n.inplaceImage.buttons=n).buttonsVisible=n.inplaceImage.inplaceImageButtonsVisible},n.add=function(e,t){"change"===t.type&&n.inplaceImage.fileChange(e,t,"add")},n.update=function(e,t){"change"===t.type&&n.inplaceImage.fileChange(e,t,"update")},n.delete=function(e){n.inplaceImage.fileChange(null,e,"delete")}}window.angular.module("inplace").controller("InplaceImageButtonsCtrl",e),e.$inject=["inplaceService"]}(),function(){"use strict";function e(e,t,n){var a=this;a.callbacks=[],a.$onInit=function(){a.needReinit={},a.inplaceParams=a.inplaceParams()},a.active=function(){a.startContent=a.editor.getData(),a.isShow=!0},a.save=function(){var e;null==a.product||null==a.product.offerSelected||null!=(e=a.convertToFloat(a.editor.getData()))&&(e=angular.extend(a.inplaceParams,{content:e,id:a.product.offerSelected.OfferId,field:a.type}),n.save(a.inplaceUrl,e).finally(function(){a.isShow=!1,a.product.refreshPrice().then(function(){a.setNeedReinit(),t(function(){a.callCallbacks(a.callbacks)},300)})}))},a.setNeedReinit=function(){for(var e in a.needReinit)a.needReinit.hasOwnProperty(e)&&(a.needReinit[e]=!0)},a.cancel=function(){a.isShow=!1,a.editor.container.$.innerHTML=a.startContent},a.convertToFloat=function(e){var t=e.replace(/,/g,".").replace(/ /g,"").replace(/&nbsp;/g,"");return t=0===e.length?0:!1===/^[0-9]+(\.[0-9][0-9])?$/.test(t)?null:parseFloat(t)},a.addCallback=function(e){a.callbacks.push(e)},a.callCallbacks=function(e){e.forEach(function(e){e()})},a.destroy=function(){e.$destroy()}}window.angular.module("inplace").controller("InplacePriceCtrl",e),e.$inject=["$scope","$timeout","inplaceService"]}(),function(){"use strict";function e(n,a,e){var i=this;i.$onInit=function(){i.inplacePrice=e.getInplacePrice(i.inplacePricePanel),i.inplacePrice.panel={element:n,ctrl:i},null!=i.onInit&&i.onInit({callback:i.calcAndSetPositionPanel})},i.$postLink=function(){i.calcAndSetPositionPanel()},i.calcAndSetPositionPanel=function(){var e=i.inplacePrice.elementTrigger.getBoundingClientRect(),t=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);n.css({bottom:t-a.pageYOffset-e.top,left:e.left})}}window.angular.module("inplace").controller("InplacePricePanelCtrl",e),e.$inject=["$element","$window","inplaceService"]}(),function(){"use strict";function e(t,e,n,a){var i=this;i.$onInit=function(){i.inplacePrice=e.getInplacePrice(i.inplacePriceButtons),i.inplacePrice.buttons={element:t,ctrl:i},null!=i.onInit&&i.onInit({callback:i.calcAndSetPositionButtons})},i.$postLink=function(){i.calcAndSetPositionButtons()},i.calcAndSetPositionButtons=function(){var e=i.inplacePrice.elementTrigger.getBoundingClientRect();t.css({top:n.pageYOffset+e.bottom,right:a[0].body.clientWidth-e.right})},i.btnSave=function(){i.inplacePrice.clickedButtons=!0,i.inplacePrice.save()},i.btnCancel=function(){i.inplacePrice.clickedButtons=!0,i.inplacePrice.cancel()}}window.angular.module("inplace").controller("InplacePriceButtonsCtrl",e),e.$inject=["$element","inplaceService","$window","$document"]}(),function(){"use strict";function e(e){var t=this;t.$onInit=function(){t.state=e.getProgressState()}}window.angular.module("inplace").controller("InplaceProgressCtrl",e),e.$inject=["inplaceService"]}(),function(){"use strict";function e(n){var e=this,t={show:!1},a={rich:{},inplaceAutocomplete:{},inplaceImage:{},inplacePrice:{}};e.addRich=function(e,t,n){t.elementTrigger=n,a.rich[e]=t},e.getRich=function(e){return a.rich[e]},e.addInplaceAutocomplete=function(e,t){a.inplaceAutocomplete[e]=t},e.getInplaceAutocomplete=function(e){return a.inplaceAutocomplete[e]},e.addInplaceImage=function(e,t){a.inplaceImage[e]=t},e.getInplaceImage=function(e){return a.inplaceImage[e]},e.addInplacePrice=function(e,t,n){a.inplacePrice[e]=t,a.inplacePrice[e].elementTrigger=n},e.getInplacePrice=function(e){return a.inplacePrice[e]},e.save=function(e,t){return n.post(e,angular.extend(t,{rnd:Math.random()}))},e.setEnable=function(e){return n.post("inplaceeditor/setenable",{isEnabled:e}).then(function(e){return e.data})},e.getProgressState=function(){return t},e.startProgress=function(){t.show=!0},e.stopProgress=function(){t.show=!1},e.destroyAll=function(){Object.keys(a).forEach(function(t){Object.keys(a[t]).forEach(function(e){null!=a[t][e].destroy&&(a[t][e].destroy(),delete a[t][e])})})}}window.angular.module("inplace").service("inplaceService",e),e.$inject=["$http"]}();